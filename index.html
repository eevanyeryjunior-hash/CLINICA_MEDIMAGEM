<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pesquisa de SatisfaÃ§Ã£o - Clinica Medimagem</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- Modal CPF -->
  <div class="overlay" id="cpfOverlay">
    <div class="modal">
      <div class="logo-header">
        <img src="logo.jpg" alt="Clinica Medimagem">
      </div>

      <h3 class="titulo-vermelho">Pesquisa de SatisfaÃ§Ã£o</h3>
      <p>Preencha as informaÃ§Ãµes abaixo para iniciar a pesquisa:</p>
      <input type="tel" id="cpf" maxlength="14" inputmode="numeric" placeholder="000.000.000-00">
      <button onclick="iniciarPesquisa()">INICIAR</button>
    </div>
  </div>

  <!-- ConteÃºdo Principal -->
  <div class="container" id="formContainer">
    <div class="left-panel" id="leftPanel">
      <h2>Avalie</h2>
      <p>De 0 a 10, o quanto vocÃª recomendaria<br><strong>CLINICA MEDIMAGEM</strong>?</p>
      <div id="smiley" class="smiley">ğŸ™‚</div>
      <div class="slider-wrapper">
        <div class="slider" id="scoreSlider">
          <span>0</span><span>1</span><span>2</span><span>3</span><span>4</span>
          <span>5</span><span>6</span><span>7</span><span>8</span><span>9</span>
          <span>10</span>
        </div>
      </div>
    </div>

    <div class="right-panel">
      <h3>Deixe sua opiniÃ£o</h3>
      <div class="feedback-row"><span>Espera</span><div class="thumbs"><button class="down">ğŸ‘</button><button class="up">ğŸ‘</button></div></div>
      <div class="feedback-row"><span>Estrutura</span><div class="thumbs"><button class="down">ğŸ‘</button><button class="up">ğŸ‘</button></div></div>
      <div class="feedback-row"><span>RecepÃ§Ã£o</span><div class="thumbs"><button class="down">ğŸ‘</button><button class="up">ğŸ‘</button></div></div>
      <div class="feedback-row"><span>Enfermagem</span><div class="thumbs"><button class="down">ğŸ‘</button><button class="up">ğŸ‘</button></div></div>
      <div class="feedback-row"><span>MÃ©dicos</span><div class="thumbs"><button class="down">ğŸ‘</button><button class="up">ğŸ‘</button></div></div>

      <h3>Como podemos melhorar?</h3>
      <textarea placeholder="Escreva aqui..."></textarea>
      <button class="enviar" id="btnEnviar" onclick="enviarFeedback()" disabled>ENVIAR</button>
    </div>
  </div>

  <!-- Tela de Agradecimento -->
  <div class="thank-you" id="thankYouScreen" style="display:none;">
    <h2>Obrigado!</h2>
    <p>Sua opiniÃ£o foi registrada com sucesso.</p>
    <p>ğŸ™ Agradecemos sua colaboraÃ§Ã£o.</p>
    <button id="btnRelatorio" class="enviar">VER RELATÃ“RIO</button>
  </div>

  <!-- Modal de Login -->
  <div class="overlay" id="loginOverlay" style="display:none;">
    <div class="modal">
      <h3>Acesso Restrito</h3>
      <p>Digite seu usuÃ¡rio e senha para ver os relatÃ³rios.</p>
      <input type="text" id="loginUser" placeholder="UsuÃ¡rio">
      <input type="password" id="loginPass" placeholder="Senha">
      <button onclick="verificarLogin()">ENTRAR</button>
    </div>
  </div>

  <!-- RelatÃ³rio -->
  <div class="report-overlay" id="reportOverlay" style="display:none;">
    <div class="report-modal">
      <h3>ğŸ“Š RelatÃ³rios - Clinica Medimagem</h3>

      <div class="report-header">
        <div class="filter-group">
          <label class="filter-title"><i class="fas fa-calendar-alt"></i> PerÃ­odo de AnÃ¡lise</label>
          <select id="periodSelect" class="styled-select">
            <option>Todos os dados</option>
            <option>Ãšltimos 7 dias</option>
            <option>Ãšltimos 30 dias</option>
            <option>Ãšltimos 90 dias</option>
          </select>
        </div>

        <div class="categories-group">
          <label class="filter-title"><i class="fas fa-filter"></i> Categorias VisÃ­veis</label>
          <div class="checkbox-list compact">
            <label><input type="checkbox" checked> Espera</label>
            <label><input type="checkbox" checked> Estrutura</label>
            <label><input type="checkbox" checked> RecepÃ§Ã£o</label>
            <label><input type="checkbox" checked> Enfermagem</label>
            <label><input type="checkbox" checked> MÃ©dicos</label>
          </div>
        </div>

        <div class="actions-group">
          <label class="filter-title"><i class="fas fa-download"></i> AÃ§Ãµes</label>
          <button class="btn orange" id="btnExportXLS">â¬‡ Exportar Excel (.xls)</button>
          <button class="btn gray" onclick="atualizarDados()">âŸ³ Atualizar Dados</button>
          <button class="btn green" onclick="gerarTodasContagens()">ğŸ“ˆ Gerar Todas as Contagens</button>
          <button class="btn red" onclick="zerarTodasContagens()">ğŸ—‘ï¸ Zerar Todas as Contagens</button>
          <label class="auto-refresh"><input type="checkbox"> Auto-atualizar (5seg)</label>
        </div>
      </div>

      <hr>

      <div class="metrics">
        <div>
          <strong id="totalRespostas">10</strong>
          <span>Respostas</span>
        </div>
        <div>
          <strong id="npsScore" style="color:#27ae60;">60</strong>
          <span>NPS Score</span>
        </div>
        <div>
          <strong id="totalComentarios">0</strong>
          <span>ComentÃ¡rios</span>
        </div>
        <div>
          <strong id="promotores" style="color:#9b59b6;">80%</strong>
          <span>Promotores</span>
        </div>
      </div>

      <!-- Tabela de respostas detalhadas -->
      <h4 style="margin-top: 20px; text-align:center;">Respostas Detalhadas</h4>
      <table id="reportTable">
        <thead>
          <tr>
            <th>CPF</th>
            <th>Nota</th>
            <th>Espera</th>
            <th>Estrutura</th>
            <th>RecepÃ§Ã£o</th>
            <th>Enfermagem</th>
            <th>MÃ©dicos</th>
            <th>ComentÃ¡rio</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <button class="closeReport" onclick="fecharRelatorio()">Fechar</button>
    </div>
  </div>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="script.js"></script>
  <script>
    // Adicionando listener do botÃ£o XLS
    const btnExportXLS = document.getElementById('btnExportXLS');
    if(btnExportXLS) {
      btnExportXLS.addEventListener('click', function() {
        if(typeof exportXLS === "function") exportXLS();
        else alert("FunÃ§Ã£o exportXLS nÃ£o encontrada!");
      });
    }
  </script>
</body>
</html>

